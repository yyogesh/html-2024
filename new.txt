
import React, { CSSProperties } from 'react';
import { Rect } from '../types';
import { Tooltip } from './Tooltip';
import { getAssetURL, openSidePanel } from '../services/chromeApi';
import { processArticle } from '../utils/contentProcessor';

interface FloatingToolbarProps {
  position: Rect;
  selectedText: string;
  onClose: () => void;
}

export const FloatingToolbar: React.FC<FloatingToolbarProps> = ({ position, selectedText, onClose }) => {
    const handleCopy = async () => {
        await navigator.clipboard.writeText(selectedText);
        // Add visual feedback if desired
    };

    const handleExplain = () => {
        const articleData = processArticle(document);
        openSidePanel('explain_this', {
            message: `Explain this text:\n\n${selectedText}`,
            ...articleData
        });
        onClose();
    };

    const style: CSSProperties = {
        position: 'fixed',
        top: `${position.top + window.scrollY - 40}px`,
        left: `${position.left + window.scrollX}px`,
        // ... other styles from your original code, preferably in a CSS file
        zIndex: 2147483647,
        display: 'flex',
        background: 'white',
        borderRadius: '8px',
        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
        padding: '4px',
    };

  return (
    <div id="aig-lite-toolbar" style={style} onMouseLeave={onClose}>
        <Tooltip text="Open AIG Lite">
            <button onClick={() => openSidePanel('toolbar_logo')}>
                <img src={getAssetURL('icon.png')} alt="AIG Lite" style={{ width: 16, height: 16 }} />
            </button>
        </Tooltip>
        <Tooltip text="Copy">
            <button onClick={handleCopy}> {/* SVG Icon */} </button>
        </Tooltip>
        <Tooltip text="Explain">
            <button onClick={handleExplain}> {/* SVG Icon */} </button>
        </Tooltip>
        {/* The OptionsDropdown component would go here */}
    </div>
  );
};
