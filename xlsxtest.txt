test('should safely skip formatting when exportHeaderText contains empty string', () => {
  // Arrange
  fixture.componentRef.setInput('columnDefinitionsArray', ['col1']);
  fixture.componentRef.setInput('title', 'TestExport');
  fixture.componentRef.setInput('data', () => [{ col1: 'value1' }]);

  // exportHeaderText includes an empty row that won’t generate a cell
  fixture.componentRef.setInput('exportHeaderText', [
    '',  // <-- this ensures worksheet[cellRef] is undefined
    'Valid Header'
  ]);

  const writeFileSpy = jest.spyOn(XLSX, 'writeFile').mockImplementationOnce(() => {});

  // Act
  component.exportToExcel();

  // Assert
  expect(writeFileSpy).toHaveBeenCalled();

  const workbookArg = writeFileSpy.mock.calls[0][0];
  const sheetName = Object.keys(workbookArg.Sheets)[0];
  const worksheet = workbookArg.Sheets[sheetName];

  const getCellValue = (addr: string) => worksheet[addr]?.v;

  // First row was empty → skipped styling
  expect(getCellValue('A1')).toBeUndefined();

  // Second row contains header text
  expect(getCellValue('A2')).toBe('Valid Header');

  // Column header still comes after blank rows
  expect(getCellValue('A5')).toBe('col1');
  expect(getCellValue('A6')).toBe('value1');
});
