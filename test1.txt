import { useChromeApi } from '../hooks/useChromeApi';

/**
 * Logs a specific event with additional data to the service worker.
 * @param {string} eventName - The name of the event to log.
 * @param {Object} [additionalData={}] - Extra data to include with the log.
 * @returns {Promise<void>}
 */
export const logToolbarEvent = async (eventName, additionalData = {}) => {
  const { isAvailable, sendMessage } = useChromeApi();
  if (!isAvailable()) {
    console.warn(`AIG Lite: Chrome APIs not available, cannot log event: ${eventName}`);
    return;
  }

  try {
    await sendMessage({
      action: 'logToService',
      logData: {
        event: eventName,
        url: window.location.href,
        title: document.title,
        domain: window.location.hostname.replace(/^www\./, ''),
        timestamp: Date.now(),
        ...additionalData,
      },
    });
  } catch (error) {
    console.warn('AIG Lite: Error logging toolbar event:', error);
  }
};
